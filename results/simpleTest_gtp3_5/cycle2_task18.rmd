prompt:
We have the following datasets. One of the dataset contains CpG methylation values per CpG and per individual as a table this is contained in the “metRmOlWithDbgapIdHeader.txt” file. Each column is an individual represented by a DBGapId, which is included as the first row. Each row is a CpG represented by "CpG_id", values in the table are methylation values. Another data set is contained in “subjects.txt”. This file has the information on the individuals. Most important feature for us here are the "Age","sex" and "Race" columns. The "dbGap ID" column (second column) in this table should match the first row of the "metRmOlWithDbgapIdHeader.txt", and they represent the same individuals. Find all CpGs associated with Age but not with sex or Race, and display top 20 CpGs.

response:
```
# Read the datasets
metRmOl <- read.table("metRmOlWithDbgapIdHeader.txt", header = TRUE, stringsAsFactors = FALSE)
subjects <- read.table("subjects.txt", header = TRUE, stringsAsFactors = FALSE)

# Subset the columns of interest from the subjects dataset
subjects_subset <- subjects[, c("dbGap ID", "Age", "sex", "Race")]

# Transpose the metRmOl dataset to have individuals as rows and CpGs as columns
metRmOl_transposed <- as.data.frame(t(metRmOl))
colnames(metRmOl_transposed) <- metRmOl_transposed[1, ]  # Set the column names as the first row
metRmOl_transposed <- metRmOl_transposed[-1, ]  # Remove the first row

# Match the dbGap ID column in subjects_subset with the column names in metRmOl_transposed
matched_cpgs <- metRmOl_transposed[, which(colnames(metRmOl_transposed) %in% subjects_subset$`dbGap ID`)]

# Filter the CpGs associated with Age but not with sex or Race
age_cpgs <- matched_cpgs[which(!is.na(subjects_subset$Age)), ]  # Exclude missing Age values
sex_cpgs <- matched_cpgs[which(is.na(subjects_subset$sex)), ]  # Include missing sex values
race_cpgs <- matched_cpgs[which(is.na(subjects_subset$Race)), ]  # Include missing Race values
age_only_cpgs <- age_cpgs[!(rownames(age_cpgs) %in% rownames(sex_cpgs) | rownames(age_cpgs) %in% rownames(race_cpgs)), ]

# Display top 20 CpGs
top_20_cpgs <- head(age_only_cpgs, n = 20)
top_20_cpgs
```

